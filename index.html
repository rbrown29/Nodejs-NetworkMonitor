<!DOCTYPE html>
<html>
  <head>
    <title>Node TrackerJacker</title>
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Syne+Mono&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <header>
      <div class="container">
        <h1>Node TrackerJacker</h1>
      </div>
    </header>
    <div class="container">
      <h2>WiFi Networks</h2>
      <ul id="networks"></ul>
      <h2>Alerts</h2>
      <ul id="alerts"></ul>
      <h2>Device Information</h2>
      <ul id="packets"></ul>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io();

      socket.on("wifiScanResults", (networks) => {
        const list = document.getElementById("networks");
        list.innerHTML = "";

        networks.forEach((network) => {
          const item = document.createElement("li");
          item.textContent = `SSID: ${network.ssid}, Signal Level: ${network.signal_level} dBm`;
          list.appendChild(item);
        });
      });

      socket.on("newDeviceAlert", (newDevices) => {
        console.log("Received newDeviceAlert:", newDevices);
        const alerts = document.getElementById("alerts");
        newDevices.forEach((device) => {
          const item = document.createElement("li");
          item.textContent = `New Device Detected: MAC ${device.mac}, BSSID ${
            device.bssid
          }, SSID ${device.ssid}, Channel ${device.channel}, Frequency ${
            device.frequency
          } MHz, Signal Level ${device.signal_level} dBm, Quality ${
            device.quality
          }, Security ${
            device.security
          }, Security Flags ${device.security_flags.join(", ")}`;
          alerts.appendChild(item);
        });
      });

      socket.on("packet", (packet) => {
        console.log("Received packet:", packet);
        const packets = document.getElementById("packets");
        console.log("Packets element:", packets);

        if (packets) {
          const item = document.createElement("li");
          item.textContent = `Channel: ${packet.channel}, Frequency: ${
            packet.frequency
          } MHz, Signal Level: ${packet.signal_level} dBm, Quality: ${
            packet.quality
          }, Security: ${
            packet.security
          }, Security Flags: ${packet.security_flags.join(", ")}`;
          console.log("Packet item:", item);
          packets.appendChild(item);
        } else {
          console.error("Packets element not found.");
        }
      });
    </script>
  </body>
</html>
